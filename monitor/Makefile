RTE_SDK=$(CURRENT_DIR)dpdk-18.02
RTE_TARGET ?= x86_64-native-linuxapp-gcc
SRC_ROOT=$(CURRENT_DIR)

include $(RTE_SDK)/mk/rte.vars.mk
APP = monitor
SRCS-y := monitor.c

#CFLAGS += -g
CFLAGS += -Ofast
CFLAGS += -Wno-deprecated-declarations
LDLIBS += -lrte_eal -lrte_ring -lrte_mempool -lrte_mbuf #-lrte_mempool_ring
LINUX_HEADERS=$(SRC_ROOT)stack_and_service/
DPDK_HEADERS=$(RTE_SDK)/x86_64-native-linuxapp-gcc/include
ALL_HEADERS = -I$(LINUX_HEADERS) -I$(DPDK_HEADERS) -I$(LINUX_HEADERS)service
CFLAGS += $(ALL_HEADERS) -DMAXCPU=32 -D__UAPI_DEF_IN6_ADDR=1 -D__UAPI_DEF_SOCKADDR_IN6=1 -D__UAPI_DEF_IN6_ADDR_ALT=1 -DCONFIG_INET\
-D__UAPI_DEF_IPPROTO_V6=1 -DCONFIG_SLAB -DCONFIG_HZ=1000 -DNR_CPUS=32 -DCONFIG_64BIT -DCONFIG_SMP \
-DCONFIG_NETFILTER -DCONFIG_NETLABEL -DCONFIG_NET_POLL_CONTROLLER \
-DCONFIG_X86_64 -DCONFIG_GENERIC_ATOMIC64 -DTCP_BIND_CACHE_SIZE=16384 \
-DINET_PEER_CACHE_SIZE=16384 -DSOCK_CACHE_SIZE=32768 -DRUN_TO_COMPLETE -DMAX_PKT_BURST=32 \
-DMULTIPLE_MEM_ALLOC=0 -DOPTIMIZE_SENDPAGES -DOPTIMIZE_TCP_RECEIVE -DCONFIG_SYN_COOKIES -DLIGHT_UDP_OPTIMIZATION -DOFFLOAD_NOT_YET

include $(RTE_SDK)/mk/rte.extapp.mk
